/* Copyright Daily Information Ltd 2020 */
function extend(){for(var i=1;i<arguments.length;i++)for(var key in arguments[i])arguments[i].hasOwnProperty(key)&&(arguments[0][key]=arguments[i][key]);return arguments[0]}function auth_response_change_callback(response){}function auth_status_change_callback(response){}function statusChangeCallback(response){"connected"===response.status?testAPI():response.status}function checkLoginState(){FB.getLoginStatus(function(response){statusChangeCallback(response)})}function testAPI(){FB.api("/me",function(response){})}function userFlagThing(id,parity,elem,type){var elemChild=elem.children(".di-user-flag:first");elemChild.addClass("fa-spin in-progress");var ret=!1,data={id:id,type:type,parity:parity};return $.get("/flag.php",data).done(function(data){return d=data.trim(),"success"==data.trim()?(userFlagThingCallback(elem,parity),ret=!0,!0):(elemChild.removeClass("fa-spin in-progress"),!1)}),ret}function userFlagThingCallback(elem,parity){var funcPrefix="on"===parity?"add":"remove",elemChild=elem.children(".di-user-flag:first");elem[funcPrefix+"Class"]("di-user-flagged"),"on"===parity?(elemChild.removeClass("far"),elemChild.addClass("fas")):(elemChild.removeClass("fas"),elemChild.addClass("far")),elemChild.removeClass("fa-spin in-progress")}function userIsLoggedIn(){return!!("di"in window&&"user"in di&&"id"in di.user&&$.isNumeric(di.user.id))}function flag(id,parity,type){"ad"!==type&&(type="event"),xmlhttp=new_xmlhttp(),xmlhttp.open("GET","/flag.php?id="+id+"&type="+type+"&flag="+parity,!0),xmlhttp.onreadystatechange=function(){4==xmlhttp.readyState&&("success"==xmlhttp.responseText.trim()?display_flag(id,parity,type):(alert("There was a problem flagging this "+type+", your login may have timed out."),display_flag(id,"out",type)))},xmlhttp.send(null)}function new_xmlhttp(){var xmlhttp=!1;if(!xmlhttp&&"undefined"!=typeof XMLHttpRequest)try{xmlhttp=new XMLHttpRequest}catch(e){xmlhttp=!1}if(!xmlhttp&&window.createRequest)try{xmlhttp=window.createRequest()}catch(e){xmlhttp=!1}return xmlhttp}function activateDropDownSubmenu(row){var $row=$(row),submenuId=$row.data("submenuId"),$submenu=$("#"+submenuId),height=$ddMenu.outerHeight();$ddMenu.outerWidth();$submenu.css({display:"block",position:"absolute",top:height})}function deactivateDropDownSubmenu(row){var $row=$(row),submenuId=$row.data("submenuId");$("#"+submenuId).css("display","none"),$row.find("a").removeClass("maintainHover")}function activateSubmenu(row){var $row=$(row),submenuId=$row.data("submenuId"),$submenu=$("#"+submenuId),height=$menu.outerHeight(),width=$menu.outerWidth();$submenu.css({display:"block",position:"absolute",top:-3,left:width-3,minHeight:height}),$row.find("a").addClass("maintainHover")}function deactivateSubmenu(row){var $row=$(row),submenuId=$row.data("submenuId");$("#"+submenuId).css("display","none"),$row.find("a").removeClass("maintainHover")}function limitText(limitField,readoutId,limitNum){if(void 0!=limitField.value)if(limitField.value.length>limitNum)limitField.value=limitField.value.substring(0,limitNum);else{var countval=limitNum-limitField.value.length;$("#"+readoutId).text(countval)}}function shuffle(array){for(var t,i,m=array.length;m;)i=Math.floor(Math.random()*m--),t=array[m],array[m]=array[i],array[i]=t;return array}$(function(){$(".a-responded").each(function(){var $el=$(this),adId=$el.attr("data-di-ads-responded-item-id");di.user&&di.user.ads_responded_to_ids&&di.user.ads_responded_to_ids[adId]&&($el.find(".time").html(moment.unix(di.user.ads_responded_to_ids[adId]).fromNow()),$el.show())})}),$(document).ready(function(){$("article.official-review blockquote").each(function(){var $this=$(this),twitterText=$this.text();twitterText.length>86&&(twitterText=twitterText.substr(0,86)+"..."),twitterText='"'+twitterText+'"';var twitterUrlText=encodeURIComponent(twitterText+" @DailyInfoOxford review:"),twitterShareUrl="https://twitter.com/share?text="+twitterUrlText,twitterShareHtml='<a href="'+twitterShareUrl+'" class="social-share-icon--twitter" onclick="javascript:window.open(this.href,\'\', \'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600\');return false;"></a>',emailShareUrl=document.location.href,emailShareText=encodeURIComponent('"'+$this.text()+'"'),emailShareHtml='<a class="social-share-icon--email" href="mailto:?subject=&body='+emailShareText+"%0A%0A"+emailShareUrl+'"></span></a>',$shareIconsContainer=$("<div></div>");$shareIconsContainer.addClass("blockquote-social-share-icons-container"),$shareIconsContainer.append(twitterShareHtml),$shareIconsContainer.append(emailShareHtml),$this.append($shareIconsContainer)})}),di=di||{},window.fbAsyncInit=function(){FB.init({appId:"106154589482561",cookie:!0,xfbml:!0,version:"v2.3"}),FB.Event.subscribe("auth.authResponseChange",auth_response_change_callback),FB.Event.subscribe("auth.statusChange",auth_status_change_callback),FB.getLoginStatus(function(response){statusChangeCallback(response)})},function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];d.getElementById(id)||(js=d.createElement(s),js.id=id,js.src="//connect.facebook.net/en_US/sdk.js",fjs.parentNode.insertBefore(js,fjs))}(document,"script","facebook-jssdk"),$(function(){$(".button-facebook-login").on("click",function(){FB.login(function(response){response&&"connected"===response.status&&(di.config.page.isLoginPage?window.location.href="/login?fbLoginCallback=1":di.config.page.isCreateAccountPage&&(window.location.href="/?fbLoginCallback=1"))},{scope:"email"})})}),$(document).on("click",".a-star",function(e){e.preventDefault();var id=$(this).attr("data-di-flag-item-id"),parity=$(this).hasClass("di-user-flagged")?"off":"on",type=$(this).attr("data-di-flag-item-type");if(!userIsLoggedIn())return alert("Please login to save this "+type+" to your account."),!1;if(userFlagThing(id,parity,$(this),type));}),$(document).ready(function(){di.user&&"object"==typeof di.user.flagged_ad_ids&&$.each(di.user.flagged_ad_ids,function(index,value){userFlagThingCallback($("#"+value+" .a-star"),"on")})});var $ddMenu=$(".no-touch #main-nav-bar"),exitTimeoutId,enableDropdowns=!1;enableDropdowns&&$ddMenu.length>0&&($menuAimMenu=$ddMenu.menuAim({activate:activateDropDownSubmenu,deactivate:deactivateDropDownSubmenu,submenuDirection:"below",exitMenu:function(row){return!1},exit:function(row){var that=this;return exitTimeoutId=window.setTimeout(function(){deactivateDropDownSubmenu(row),that.clearActiveRow()},200),!1},enter:function(row){window.clearTimeout(exitTimeoutId)}}));var $menu=$("#flyout-nav");$menu.menuAim({activate:activateSubmenu,deactivate:deactivateSubmenu,submenuDirection:"right",exitMenu:function(){}}),$(".flyout-nav li").click(function(e){e.stopPropagation()}),$(document).click(function(){$(".popover").css("display","none"),$("a.maintainHover").removeClass("maintainHover")}),$(document).foundation({reveal:{animation:"fade",animation_speed:0}}),jQuery.extend({getQueryParameters:function(str){return(str||document.location.search).replace(/(^\?)/,"").split("&").map(function(n){return n=n.split("="),this[n[0]]=n[1],this}.bind({}))[0]}}),$(document).on("click",".login-button",function(e){console.log(e);var params={};params.path=document.location.pathname,serializableForm=$("form.serializable-form:first");var documentHasFormToSerialize=serializableForm.length>0;if(console.log(documentHasFormToSerialize),documentHasFormToSerialize){e.preventDefault(),serializedForm=serializableForm.serialize();var uniqid=serializableForm.find('input[name="di_redirect_token"]').val(),value=serializedForm;return $.ajax({url:"/save-for-later",method:"post",data:{saveForLaterToken:uniqid,value:value}}).done(function(){var path=di.utils.setQueryParam(window.location.href,"di_redirect_token",uniqid);window.history.replaceState({},"",path),window.location.href="https://"+window.location.hostname+"/login"}),!1}return!0}),function(e){"use strict";var t=function(){var e=document.createElement("div");return e.style.cssText="font-size: 1rem;",/rem/.test(e.style.fontSize)},n=function(){for(var e=document.getElementsByTagName("link"),t=[],n=0;n<e.length;n++)"stylesheet"===e[n].rel.toLowerCase()&&null===e[n].getAttribute("data-norem")&&t.push(e[n].href);return t},r=function(){for(var e=0;e<h.length;e++)l(h[e],o)},o=function(e,t){if(p.push(e.responseText),v.push(t),v.length===h.length){for(var n=0;n<v.length;n++)a(p[n],v[n]);(h=m.slice(0)).length>0?(v=[],p=[],m=[],r()):i()}},a=function(e,t){for(var n,r=d(e).replace(/\/\*[\s\S]*?\*\//g,""),o=/[\w\d\s\-\/\\\[\]:,.'"*()<>+~%#^$_=|@]+\{[\w\d\s\-\/\\%#:!;,.'"*()]+\d*\.?\d+rem[\w\d\s\-\/\\%#:!;,.'"*()]*\}/g,a=r.match(o),i=/\d*\.?\d+rem/g,s=r.match(i),c=/(.*\/)/,l=c.exec(t)[0],u=/@import (?:url\()?['"]?([^'\)"]*)['"]?\)?[^;]*/gm;null!==(n=u.exec(e));)m.push(0===n[1].indexOf("/")?n[1]:l+n[1]);null!==a&&0!==a.length&&(f=f.concat(a),g=g.concat(s))},i=function(){for(var e=/[\w\d\s\-\/\\%#:,.'"*()]+\d*\.?\d+rem[\w\d\s\-\/\\%#:!,.'"*()]*[;}]/g,t=0;t<f.length;t++){u+=f[t].substr(0,f[t].indexOf("{")+1);for(var n=f[t].match(e),r=0;r<n.length;r++)u+=n[r],r===n.length-1&&"}"!==u[u.length-1]&&(u+="\n}")}s()},s=function(){for(var e=0;e<g.length;e++)y[e]=Math.round(parseFloat(g[e].substr(0,g[e].length-3)*w))+"px";c()},c=function(){for(var e=0;e<y.length;e++)y[e]&&(u=u.replace(g[e],y[e]));var t=document.createElement("style");t.setAttribute("type","text/css"),t.id="remReplace",document.getElementsByTagName("head")[0].appendChild(t),t.styleSheet?t.styleSheet.cssText=u:t.appendChild(document.createTextNode(u))},l=function(t,n){try{var r=e.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP")||new ActiveXObject("Msxml2.XMLHTTP"):new XMLHttpRequest;r.open("GET",t,!0),r.onreadystatechange=function(){4===r.readyState&&n(r,t)},r.send(null)}catch(o){if(e.XDomainRequest){var a=new XDomainRequest;a.open("get",t),a.onload=function(){n(a,t)},a.onerror=function(){return!1},a.send()}}},d=function(t){return e.matchMedia||e.msMatchMedia||(t=t.replace(/@media[\s\S]*?\}\s*\}/g,"")),t};if(!t()){var u="",h=n(),m=[],f=[],g=[],p=[],v=[],y=[],w="";w=function(){var e,t=document,n=t.documentElement,r=t.body||t.createElement("body"),o=!t.body,a=t.createElement("div"),i=r.style.fontSize;return o&&n.appendChild(r),a.style.cssText="width:1em; position:absolute; visibility:hidden; padding: 0;",r.style.fontSize="1em",r.appendChild(a),e=a.offsetWidth,o?n.removeChild(r):(r.removeChild(a),r.style.fontSize=i),e}(),r()}}(window),di.populateSidebar=function(sideBarElement,adjacentElement,apendees,apendeeType,comparatorElement){"string"!=typeof apendeeType&&(apendeeType="magicBoxes"),"string"!=typeof comparatorElement&&(comparatorElement=!1),di.widgets=di.widgets||{},di.widgets.sidebar=di.widgets.sidebar||[];var sidebar={};if(sidebar.adjacent={},sidebar.elem=sideBarElement,!(sidebar.elem instanceof jQuery&&sidebar.elem.length>0))return!1;var parent=sidebar.elem.parents(".sidebar-container");parent.length?sidebar.container=parent:sidebar.container=sidebar.elem,sidebar.adjacent.elem=adjacentElement,sidebar.adjacent.elem?sidebar.adjacent.height=sidebar.adjacent.elem.height():(sidebar.adjacent={},sidebar.adjacent.height=1/0),comparatorElement&&(sidebar.comparatorElement=$(comparatorElement));var gutter=10,insertion={};if(apendees.hasOwnProperty("eventColumnLinkedAds")&&apendees.eventColumnLinkedAds.hasOwnProperty("content"))try{apendees.eventColumnLinkedAds.content=shuffle(apendees.eventColumnLinkedAds.content)}catch(e){}return $.each(apendees,function(index,value){switch(value.type){case"magicBoxes":insertion.height=113;var sideBarHeight=sidebar.container.height(),availableHeight=sidebar.adjacent.height-sideBarHeight;$.each(value.content,function(index,value){var insertionHeight=insertion.height+gutter;if((availableHeight-=insertionHeight)>0){var html='<div class="sidebar-item">'+value+"</div>";sidebar.elem.append(html)}});break;case"html":var availableHeight=sidebar.adjacent.height;if(sidebar.comparatorElement)var remainingHeight=availableHeight-sidebar.comparatorElement.height();else var remainingHeight=availableHeight-sidebar.elem.height();if(remainingHeight<20)return!1;var html='<div class="sidebar-item">'+value.content+"</div>";sidebar.elem.append(html)}}),void di.widgets.sidebar.push(sidebar)},$(document).ready(function(){var sidebarElement=$("#sidebar");if(1===sidebarElement.length){var sidebarOptions=sidebarElement.data(),sidebarComparator=sidebarOptions.sidebarComparator?$(sidebarOptions.sidebarComparator):$("body"),sidebarType=sidebarOptions.sidebarType?sidebarOptions.sidebarType:"default",sidebarSubType=sidebarOptions.sidebarSubType?sidebarOptions.sidebarSubType:"";$.getJSON("/sidebar/"+sidebarType,{sidebarSubType:sidebarSubType},function(json){di.sidebarContent=json.content,di.populateSidebar(sidebarElement,sidebarComparator,shuffle(di.sidebarContent))})}});
//# sourceMappingURL=app.min.js.map